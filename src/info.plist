<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>bundleid</key>
	<string>com.moguyun.wps</string>
	<key>category</key>
	<string>Tools</string>
	<key>connections</key>
	<dict>
		<key>58522435-0951-4A4D-A1FC-49550C0AFB6C</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>F824E2BA-7848-4349-A7DB-7179BC53287C</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>9C1E23A0-A815-4736-BFC0-E431DBC76827</string>
				<key>modifiers</key>
				<integer>1048576</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>5335FCB0-725D-406E-8307-C5D9967B5CC7</string>
				<key>modifiers</key>
				<integer>524288</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>6AA7B8EE-4120-4D35-A4C7-CE864F761551</string>
				<key>modifiers</key>
				<integer>262144</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>CE0B8A25-E17D-4BCB-AB29-03C9FDA48CBB</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>9C1E23A0-A815-4736-BFC0-E431DBC76827</key>
		<array/>
		<key>CE0B8A25-E17D-4BCB-AB29-03C9FDA48CBB</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>31D1F874-8F24-4467-8CBE-A1B8DA027A53</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
	</dict>
	<key>createdby</key>
	<string>zacksleo &lt;zacksleo@gmail.com&gt;</string>
	<key>description</key>
	<string>搜索wps</string>
	<key>disabled</key>
	<false/>
	<key>name</key>
	<string>WPS</string>
	<key>objects</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<false/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>103</integer>
				<key>keyword</key>
				<string>wps</string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string>正在查询···</string>
				<key>script</key>
				<string>./wps {query}</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>subtext</key>
				<string>搜索WPS 文档</string>
				<key>title</key>
				<string>搜索WPS文档</string>
				<key>type</key>
				<integer>0</integer>
				<key>withspace</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>58522435-0951-4A4D-A1FC-49550C0AFB6C</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>browser</key>
				<string></string>
				<key>spaces</key>
				<string></string>
				<key>url</key>
				<string>{var:url}</string>
				<key>utf8</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.openurl</string>
			<key>uid</key>
			<string>F824E2BA-7848-4349-A7DB-7179BC53287C</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>browser</key>
				<string></string>
				<key>spaces</key>
				<string></string>
				<key>url</key>
				<string>ksoqing://type=open&amp;fileid={var:fileid}&amp;from=clouddriver</string>
				<key>utf8</key>
				<false/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.openurl</string>
			<key>uid</key>
			<string>9C1E23A0-A815-4736-BFC0-E431DBC76827</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>autopaste</key>
				<true/>
				<key>clipboardtextrtf</key>
				<string>{\rtf1\ansi\ansicpg936\cocoartf2578
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 HelveticaNeue;\f1\fnil\fcharset134 PingFangSC-Regular;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0\c84706\cname controlTextColor;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs26 \cf2 \{var:url\} \
[
\f1 \'bd\'f0\'c9\'bd\'ce\'c4\'b5\'b5
\f0 ] \{var:name\}}</string>
				<key>ignoredynamicplaceholders</key>
				<false/>
				<key>transient</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.clipboard</string>
			<key>uid</key>
			<string>5335FCB0-725D-406E-8307-C5D9967B5CC7</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>path</key>
				<string>{var:dir}</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.revealfile</string>
			<key>uid</key>
			<string>6AA7B8EE-4120-4D35-A4C7-CE864F761551</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>autopaste</key>
				<true/>
				<key>clipboardtextrtf</key>
				<string>{\rtf1\ansi\ansicpg936\cocoartf2578
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 HelveticaNeue;\f1\fnil\fcharset134 PingFangSC-Regular;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0\c84706\cname controlTextColor;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs26 \cf2 \{var:url\} \
[
\f1 \'bd\'f0\'c9\'bd\'ce\'c4\'b5\'b5
\f0 ] \{var:name\}}</string>
				<key>ignoredynamicplaceholders</key>
				<false/>
				<key>transient</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.clipboard</string>
			<key>uid</key>
			<string>31D1F874-8F24-4467-8CBE-A1B8DA027A53</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>argument</key>
				<string></string>
				<key>passthroughargument</key>
				<false/>
				<key>variables</key>
				<dict/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.utility.argument</string>
			<key>uid</key>
			<string>CE0B8A25-E17D-4BCB-AB29-03C9FDA48CBB</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
	</array>
	<key>readme</key>
	<string># WPS Alfred Workflow

Alfred Workflow for WPS Office

## 安装

打开 `https://github.com/zacksleo/wps-alfred-workflow/releases`，找到最新版本的 WPS.alfredworkflow
，下载并安装

## 配置

配置环境变量 `wps_cache_dir` 为 wps 缓存目录，如 `/Users/zacksleo/Library/Containers/com.kingsoft.wpsoffice.mac/Data/Library/Application Support/Kingsoft/WPS Cloud Files/userdata/qing/filecache/zacksleo的云文档`

`file_path_expire_mins` 文件路径缓存时间
`latest_expire_mins` 最近使用记录缓存时间
`query_expire_mins` 查询缓存时间
`groups_expire_mins` 分组缓存时间
`group_file_expire_mins` 分组目录缓存时间

## 登录

1. 登录网页版[wps](https://kdocs.cn), 登录成功后, 在 Cookie 中获取 wps_sid

2. `wps {wps_sid}`

![登录](.github/screen-shots/wps-login.png)

wps_sid 会保存在钥匙串中

## 查询最近文档

`wps`

![登录](.github/screen-shots/wps-recent.png)

## 使用关键词查询

`wps {keyword}`

![登录](.github/screen-shots/wps-search.png)

## 目录浏览

选择菜单后，使用 Tab 键盘操作

`wps /`

`wps /{path}/{subpath}`

![返回](.github/screen-shots/wps-back.png)

## 打开

1. 使用回车键，通过 kdocs.cn 在浏览器中打开文档
2. 使用 Cmd, 在客户端中打开

## 删除钥匙串重新登录

在 keychain 中，搜索 wps, 找到 wps_sid 并删除</string>
	<key>uidata</key>
	<dict>
		<key>31D1F874-8F24-4467-8CBE-A1B8DA027A53</key>
		<dict>
			<key>xpos</key>
			<integer>435</integer>
			<key>ypos</key>
			<integer>575</integer>
		</dict>
		<key>5335FCB0-725D-406E-8307-C5D9967B5CC7</key>
		<dict>
			<key>xpos</key>
			<integer>190</integer>
			<key>ypos</key>
			<integer>345</integer>
		</dict>
		<key>58522435-0951-4A4D-A1FC-49550C0AFB6C</key>
		<dict>
			<key>note</key>
			<string>Show current configuration</string>
			<key>xpos</key>
			<integer>185</integer>
			<key>ypos</key>
			<integer>95</integer>
		</dict>
		<key>6AA7B8EE-4120-4D35-A4C7-CE864F761551</key>
		<dict>
			<key>xpos</key>
			<integer>435</integer>
			<key>ypos</key>
			<integer>415</integer>
		</dict>
		<key>9C1E23A0-A815-4736-BFC0-E431DBC76827</key>
		<dict>
			<key>xpos</key>
			<integer>435</integer>
			<key>ypos</key>
			<integer>260</integer>
		</dict>
		<key>CE0B8A25-E17D-4BCB-AB29-03C9FDA48CBB</key>
		<dict>
			<key>xpos</key>
			<integer>350</integer>
			<key>ypos</key>
			<integer>605</integer>
		</dict>
		<key>F824E2BA-7848-4349-A7DB-7179BC53287C</key>
		<dict>
			<key>xpos</key>
			<integer>435</integer>
			<key>ypos</key>
			<integer>100</integer>
		</dict>
	</dict>
	<key>variables</key>
	<dict>
		<key>file_path_expire_mins</key>
		<string>1440</string>
		<key>group_file_expire_mins</key>
		<string>1440</string>
		<key>groups_expire_mins</key>
		<string>1440</string>
		<key>latest_expire_mins</key>
		<string>180</string>
		<key>query_expire_mins</key>
		<string>1440</string>
		<key>wps_cache_dir</key>
		<string>/Users/zacksleo/Library/Containers/com.kingsoft.wpsoffice.mac/Data/Library/Application Support/Kingsoft/WPS Cloud Files/userdata/qing/filecache/李俊伟的云文档</string>
	</dict>
	<key>variablesdontexport</key>
	<array>
		<string>wps_cache_dir</string>
	</array>
	<key>version</key>
	<string>0.2</string>
	<key>webaddress</key>
	<string>https://zacksleo.top</string>
</dict>
</plist>
